def uploadToAzureZip(String localZipPath) {

  azure_login()

  executeWithProxy {
    sh """
      set -euo pipefail

      echo "üì¶ uploadToAzureZip() localZipPath=${localZipPath} container=${container} dir=${directoryPath}"

      TMP_DIR="\$(mktemp -d)"
      unzip -q "${localZipPath}" -d "\${TMP_DIR}"

      # 1) Supprimer uniquement les fichiers pr√©sents dans le zip (c√¥t√© Azure)
      cd "\${TMP_DIR}"
      while IFS= read -r f; do
        # ignorer les dossiers
        if [ -f "\$f" ]; then
          echo "üóëÔ∏è delete blob: ${directoryPath}/\$f"
          az storage blob delete \\
            --account-name "${accountName}" \\
            --container-name "${container}" \\
            --name "${directoryPath}/\$f" \\
            --auth-mode login \\
            --only-show-errors || true
        fi
      done < <(find . -type f -print | sed 's|^\\./||')

      # 2) Uploader les nouveaux fichiers (contenu du zip)
      echo "‚¨ÜÔ∏è upload extracted content to ${container}/${directoryPath}"
      az storage blob upload-batch \\
        --account-name "${accountName}" \\
        --destination "${container}/${directoryPath}" \\
        --source "\${TMP_DIR}" \\
        --auth-mode login \\
        --overwrite true \\
        --only-show-errors

      rm -rf "\${TMP_DIR}"
      echo "‚úÖ Upload zip content done"
    """
  }
}
