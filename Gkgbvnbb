Tu as une erreur SLF4JBridgeHandler manquant :

Caused by: java.lang.NoClassDefFoundError: org/slf4j/bridge/SLF4JBridgeHandler
Caused by: java.lang.ClassNotFoundException: org.slf4j.bridge.SLF4JBridgeHandler

ğŸ‘‰ Cette erreur nâ€™a rien Ã  voir avec Spark lui-mÃªme,
ğŸ‘‰ elle vient de tests JUnit/Cucumber qui exÃ©cutent du code Spark sans le bon binding SLF4J.

En clair :
Spark essaye dâ€™activer le bridge JUL â†’ SLF4J, mais la classe nâ€™existe pas dans ton classpath test.


---

âœ… Solution immÃ©diate

Ajoute cette dÃ©pendance dans le scope test :

<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>jul-to-slf4j</artifactId>
    <version>1.7.36</version> 
    <scope>test</scope>
</dependency>

Ou si tu utilises SLF4J 2.x :

<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>jul-to-slf4j</artifactId>
    <version>2.0.9</version>
    <scope>test</scope>
</dependency>

Spark 3.3 / 3.4 utilise encore SLF4J 1.7.x â†’ prends la 1.7.36.


---

â— Pourquoi Ã§a apparaÃ®t dans tes CucumberPipelineTests ?

Parce que :

Spark charge ParquetFileFormat

Ce code appelle SLF4JBridgeHandler.removeHandlersForRootLogger()

Dans un environnement de test, tu n'as pas le binding SLF4J complet

â†’ erreur NoClassDefFoundError


En production, tu nâ€™as pas ce souci car ton image Docker Spark fournit tout.


---

ğŸ” VÃ©rification supplÃ©mentaire

VÃ©rifie que tu as bien aussi un binding SLF4J (logback par exemple) :

<dependency>
    <groupId>ch.qos.logback</groupId>
    <artifactId>logback-classic</artifactId>
    <version>1.2.11</version>
    <scope>test</scope>
</dependency>

Sinon tu vas avoir un autre warning :

SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".


---

âœ¨ RÃ©sumÃ© clair

1ï¸âƒ£ Le test charge Spark â†’ Spark active SLF4JBridgeHandler
2ï¸âƒ£ SLF4JBridgeHandler nâ€™est pas dans ton classpath test
3ï¸âƒ£ â†’ crash

ğŸ‘‰ Ajoute jul-to-slf4j en scope test, et câ€™est rÃ©glÃ©.


---

Si tu veux, envoie-moi ton pom.xml (partie logging & tests) et je te le corrige proprement pour Spark + JUnit + Cucumber.
