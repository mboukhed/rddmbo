private static Boolean tableClickhouseExists(SparkSession spark, String database, String table) {
    String query = String.format("DESCRIBE clickhouse.`%s`.`%s`", database, table);
    try {
        spark.sql(query).limit(1).collect(); // trigger execution
        System.out.println("‚úÖ Table exists: " + database + "." + table);
        return true;
    } 
    catch (Throwable e) { // catch Throwable to cover all Spark errors without imports
        String msg = (e.getMessage() != null) ? e.getMessage().toLowerCase() : "";

        // Cas "table inexistante"
        if (msg.contains("table or view not found") ||
            msg.contains("no such table") ||
            msg.contains("not found in catalog") ||
            msg.contains("cannot resolve") ||
            msg.contains("does not exist")) {
            System.out.println("‚ö†Ô∏è Table does NOT exist: " + database + "." + table);
            return false;
        }

        // Cas r√©seau / TLS / proxy / autres erreurs Spark
        if (msg.contains("ssl") || msg.contains("tls") || msg.contains("connection") ||
            msg.contains("timeout") || msg.contains("network")) {
            System.err.println("üö® Network-related error while checking table " + database + "." + table);
            return null; // √©tat inconnu
        }

        // Toute autre erreur Spark
        System.err.println("‚ùå Unexpected error while checking table " + database + "." + table + ": " + e);
        return null; // √©tat inconnu
    }
}
